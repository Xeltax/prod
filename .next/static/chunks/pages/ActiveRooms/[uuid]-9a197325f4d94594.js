(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{2787:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ActiveRooms/[uuid]",function(){return o(7268)}])},7268:function(e,t,o){"use strict";o.r(t),o.d(t,{__N_SSG:function(){return N},default:function(){return S}});var n=o(5893),s=o(8906),i=o(7294),r=o(1672),a=o(2414),l=o.n(a),c=o(7814),d=o(9417),u=o(7064);async function p(e){return new Promise(t=>{fetch("http://127.0.0.1:8090/api/suite/".concat(e)).then(e=>{t(e.json().then(e=>e))})})}var h=o(8353),m=o(3299),x=o(4780),j=o(3170),v=o(1091),_=o(2410);async function y(e,t){try{let o=await fetch(_.apiUrl+"/story/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.access_token},body:JSON.stringify(e)});if(!o.ok)throw Error("Failed to add story");return await o.json()}catch(e){console.error(e)}}async function f(e){try{let t=await fetch(_.apiUrl+"/story/"+e.id,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to delete story");return await t.json()}catch(e){console.error(e)}}var C=o(3432),N=!0;function S(e){let{isOpen:t,toggle:o}=(0,v.Z)(),{isOpen2:a,toggle2:N}=(0,v.Z)(),{isOpen3:S,toggle3:w}=(0,v.Z)(),[b,R]=i.useState([]),[E,k]=i.useState({}),{data:Z,status:g}=(0,m.useSession)(),[U,T]=(0,i.useState)(""),[D,O]=(0,i.useState)(""),[V,F]=(0,i.useState)(0),[J,P]=(0,i.useState)(!1),[A,M]=(0,i.useState)([]),[G,B]=(0,i.useState)(1),H={name:U,description:D,idRoom:V},[z,I]=(0,i.useState)(""),[X,L]=(0,i.useState)(""),[Q,W]=(0,i.useState)(""),[Y,q]=(0,i.useState)(""),K={username:z,password:X,email:Q,completeName:Y};(0,i.useEffect)(()=>{var t;P(!1),(t=e.room.id,new Promise(e=>{fetch(_.apiUrl+"/rooms/"+t+"?include=storys").then(t=>{e(t.json().then(e=>e.storys))})})).then(e=>{M(e)}),R(JSON.parse(e.room.connectedUsers)),p(e.room.suite).then(e=>{k(e)}),"unauthenticated"===g?o():"authenticated"===g&&(0,s.el)(e.room.uuid,null==Z?void 0:Z.user.user.id)},[e.room,g,J]);let $=[];if(E.suitevalues&&($=JSON.parse(E.suitevalues)),(null==Z?void 0:Z.user)?(0,s.el)(e.room.uuid,null==Z?void 0:Z.user.id):t||a||null!=Z&&Z.user,void 0!==e.room&&null!==e.room&&e.room)return(0,n.jsxs)(r.Z,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:l().activeRoomTitle,children:e.room.name}),(0,n.jsxs)("div",{className:l().activeRoomUsers,children:[(0,n.jsx)("div",{className:l().cardContainer,children:$&&$.map((e,t)=>(0,n.jsxs)(u.E.div,{whileHover:{scale:1.05,transition:{duration:.2},translateY:-5},className:l().card,children:[(0,n.jsx)("div",{className:l().topValue,children:e}),(0,n.jsx)("h1",{children:e}),(0,n.jsx)("div",{className:l().bottomValue,children:e})]}))}),(0,n.jsxs)("div",{className:l().usersContainer,children:[(0,n.jsxs)("p",{children:["Connect\xe9(e)s (",b.length,")"]}),b.map((e,t)=>(0,n.jsxs)("div",{className:l().connectedUsers,children:[(0,n.jsx)(c.G,{icon:d.ILF}),(0,n.jsx)("p",{children:e.username})]},t)),(0,n.jsxs)("div",{className:l().inviteMate,children:[(0,n.jsx)("p",{children:"Inviter un participant"}),(0,n.jsx)("input",{disabled:!0,type:"text",value:"http://127.0.0.1:3000/ActiveRooms/"+e.room.uuid})]})]})]}),(0,n.jsxs)("div",{className:l().storiesContainer,children:[(0,n.jsxs)("div",{className:l().storiesContainerHeader,children:[(0,n.jsxs)("div",{className:l().titleContainer,children:[(0,n.jsx)("p",{onClick:()=>B(1),children:"Active Stories"}),(0,n.jsx)("p",{onClick:()=>B(2),children:"Completed Stories"}),(0,n.jsxs)("p",{onClick:()=>[B(3)],children:["All Stories (",A.length,")"]})]}),(0,n.jsxs)("div",{className:l().buttonContainer,onClick:()=>w(),children:[(0,n.jsx)(c.G,{icon:d.r8p}),"New"]})]}),(0,n.jsx)("div",{className:l().storiesContainerBody,children:(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{style:G>1?{display:"flex",justifyContent:"space-between"}:{display:"none"},children:[(0,n.jsx)("td",{children:"Story"}),(0,n.jsx)("td",{children:"Points"})]})}),A.map((e,t)=>null===e.points?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("tr",{style:1==G?{display:"flex"}:{display:"none"},children:[(0,n.jsxs)("td",{children:[(0,n.jsx)(c.G,{icon:d.xiG})," ",e.name]}),(0,n.jsx)("td",{children:(0,n.jsx)(c.G,{onClick:()=>{f(e),A.splice(e.id),P(!0)},icon:d.Vui})})]})}):null!==e.points?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("tr",{style:2==G?{display:"flex"}:{display:"none"},children:[(0,n.jsx)("td",{children:e.name}),(0,n.jsx)("td",{children:e.points})]})}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("tr",{style:3==G?{display:"flex"}:{display:"none"},children:[(0,n.jsx)("td",{children:e.name}),(0,n.jsx)("td",{children:null==e.points?"-":e.points})]})}))]})})]})]}),(0,n.jsxs)(j.Z,{isOpen:S,toggle:w,title:"Cr\xe9er une User Story",children:[(0,n.jsx)(h.Z,{label:"Nom de la story",type:"text",inputData:T,value:U,placeholder:"Nom"}),(0,n.jsx)(h.Z,{label:"Description de la story",type:"text",inputData:O,value:D,placeholder:"Description"}),(0,n.jsx)(x.Z,{event:()=>{y(H,null==Z?void 0:Z.user),w(),P(!0)},children:"Valider"})]}),(0,n.jsxs)(j.Z,{isOpen:t,toggle:o,title:"Connexion",children:[(0,n.jsx)(h.Z,{type:"text",placeholder:"Nom d'utilisateur",inputData:I,value:z,label:"Nom d'utilisateur"}),(0,n.jsx)(h.Z,{type:"password",placeholder:"Mot de passe",inputData:L,value:X,label:"Mot de passe"}),(0,n.jsx)(x.Z,{event:()=>{o(),(0,m.signIn)("credentials",{username:z,password:X})},children:"Se connecter"}),(0,n.jsxs)("p",{children:["Vous n'avez pas encore de compte ? ",(0,n.jsx)("a",{onClick:()=>{o(),N()},children:"Cr\xe9er cotre compte"})]})]}),(0,n.jsxs)(j.Z,{isOpen:a,toggle:N,title:"Cr\xe9ation de compte",children:[(0,n.jsx)(h.Z,{type:"text",placeholder:"Nom d'utilisateur",inputData:I,value:z,label:"Nom d'utilisateur"}),(0,n.jsx)(h.Z,{type:"email",placeholder:"Addresse Email",inputData:W,value:Q,label:"Email"}),(0,n.jsx)(h.Z,{type:"text",placeholder:"Nom complet (Ex : Jhon Smith)",inputData:q,value:Y,label:"Nom complet"}),(0,n.jsx)(h.Z,{type:"password",placeholder:"Mot de passe",inputData:L,value:X,label:"Mot de passe"}),(0,n.jsx)(x.Z,{event:()=>{N(),(0,C.cn)(K)},children:"Cr\xe9er mon compte"}),(0,n.jsxs)("p",{children:["Vous avez d\xe9j\xe0 un compte ? ",(0,n.jsx)("a",{onClick:()=>{N(),o()},children:"Connect\xe9 vous"})]})]})]})}},8906:function(e,t,o){"use strict";o.d(t,{GX:function(){return r},ZP:function(){return s},dB:function(){return i},el:function(){return a}});var n=o(2410);function s(){return new Promise(e=>{fetch(n.apiUrl+"/room").then(t=>{e(t.json().then(e=>e))})})}async function i(e,t){try{let o=await fetch(n.apiUrl+"/room",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.access_token},body:JSON.stringify(e)});if(!o.ok)throw Error("Failed to add room");return await o.json()}catch(e){console.error(e)}}async function r(e){try{let t=await fetch(n.apiUrl+"/room/"+e.id,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to delete room");return await t.json()}catch(e){console.error(e)}}async function a(e,t){try{let o=await fetch(n.apiUrl+"/rooms/".concat(e,"/users/").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:""});if(!o.ok)throw Error("Failed to enter active rooms");return await o.json()}catch(e){console.error(e)}}},2414:function(e){e.exports={activeRoomTitle:"activeRoom_activeRoomTitle__05kMJ",activeRoomUsers:"activeRoom_activeRoomUsers__19oVx",cardContainer:"activeRoom_cardContainer__gsp2J",card:"activeRoom_card__HC7C_",topValue:"activeRoom_topValue__jWJ0_",bottomValue:"activeRoom_bottomValue__mzcIF",usersContainer:"activeRoom_usersContainer__eGSbZ",connectedUsers:"activeRoom_connectedUsers__ZdQfN",inviteMate:"activeRoom_inviteMate__Hj4dT",storiesContainer:"activeRoom_storiesContainer__Uv3e1",storiesContainerHeader:"activeRoom_storiesContainerHeader__XAjpD",titleContainer:"activeRoom_titleContainer__eAUEk",buttonContainer:"activeRoom_buttonContainer__o5dDS",storiesContainerBody:"activeRoom_storiesContainerBody__wgkvM"}}},function(e){e.O(0,[976,343,410,774,888,179],function(){return e(e.s=2787)}),_N_E=e.O()}]);